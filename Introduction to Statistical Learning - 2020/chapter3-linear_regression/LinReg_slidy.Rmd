---
title: "LinReg_slidy"
author: "Philipp Mildenberger"
date: "5 MÃ¤rz 2020"
output: slidy_presentation
---
<!-- --- -->
<!-- title: "Chapter 3 Linear Regression" -->
<!-- subtitle: "" -->
<!-- author: "Jan Linke </br> Philipp Mildenberger</br>" -->
<!-- date: "2020/03/16</br> -->
<!--   IMBEI - University Medical Center Mainz" -->
<!-- output:  -->
<!--   xaringan::moon_reader: -->
<!--     css: ["default", "default-fonts","css/animate.css"] -->
<!--     lib_dir: libs -->
<!--     nature: -->
<!--       highlightStyle: github -->
<!--       highlightLines: true -->
<!--       countIncrementalSlides: false -->
<!--       titleSlideClass: [center, middle] -->
<!-- --- -->

```{r setup, include=FALSE}
# library(rgl)
library(knitr)

options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  eval = TRUE,
  message = FALSE,
  echo = FALSE,
  warnings = FALSE,
  fig.align = "center",
  warning = FALSE,
  error = FALSE
)
opts_knit$set(root.dir = "../..") ## knit in grand-parent folder for the sake of easy (and consistent!) data access

## fuer 3d graphik
# knitr::knit_hooks$set(webgl=hook_webgl)
```


$$
% define makros
\def\xbar{\overline{x}}
\def\Xbar{\overline{X}}
\def\ybar{\overline{y}}
\def\Xbar{\overline{X}}

\def\eps{\epsilon}
$$

# Chapter Overview

- Motivating Example
- Simple Linear Regression
- Multiple Linear Regression
- Other Considerations in the Regression Model
- Example expained
- Comparison to $K$-Nearest Neighbors


# Motivating Example
## Data
```{r, echo=FALSE}
Advertising <- read.csv("Introduction to Statistical Learning - 2020/chapter3-linear_regression/data/Advertising.csv")
```

```{r}
DT::datatable(Advertising)
```


# Motivating Example
## Questions

* Relationship between advertising budget and `sales`?
* How strong is relationship between advertising budget and `sales`?
* Which media contribute to `sales`?
* How accurately (and precisely) can we estimate the effect of each medium?
* How accurately can we predict future sales?
* Is the relationship linear?
* Is there synergy (i.e. interaction) among the adventising media?



# Simple Linear Regression
Predict quantitative response $Y$ on the basis of $X$

$$ Y \approx \beta_0 + \beta_1 X $$

- $\beta_0$:= "Intercept"  and $\beta_1$:= "slope"
- Often called "coefficients" "parameters"
- Both are unknown, will be estimated

With estimates $\hat\beta_0$ and $\hat\beta_1$, one can make make predictions 
for $Y$ based on observed values of $X$:

$$ \hat y = \beta_0 + \beta_1 x $$

# Estimating the Coefficients $\beta_0$ an $\beta_1$ 
- Least squares method minimises the residual sum of squares (RSS) 

$$\text{RSS}:= (y_1 - \hat y_1) + \ldots + (y_n - \hat y_n)$$ 

- $\frac{d\text{RSS}}{d\beta} \stackrel{!}= 0$ yields

$$
\begin{aligned}
\hat \beta_1 =& \frac{\sum_{i=1}^n(x_i-\xbar)(y_i - \ybar)}
{\sum_{i=1}^n(x_i-\xbar)^2} \\
\hat \beta_0 =& \ybar - \hat \beta_1 \cdot \xbar
\end{aligned}
$$ 

# .
## Advertising Example
```{r}
plot(sales ~ TV, data=Advertising, pch=16, col=2)
```

# .
## Advertising Example
```{r}
lm1 <- lm(sales~TV, data=Advertising)
coefs <- lm1$coefficients
plot(sales ~ TV, data=Advertising, pch=16, col=2)
abline(a=coefs[1],b=coefs[2], lwd=2, col=4)
```

# .
## Advertising Example
```{r}
pred  <- predict(lm1)
plot(sales ~ TV, data=Advertising, pch=16, col=2)
abline(a=coefs[1],b=coefs[2], lwd=2, col=4)
with(Advertising,segments(TV, sales, TV, pred, lwd = 1))
```

# Assessing Accuracy

- true model: $Y = f(X) + \tilde\eps$ 
- best linear approximation: $Y = \beta_0 + \beta_1 + \eps$
- $\beta_0$, $\beta_1$ define the *popular regression line*

Beispiel zu Figure 3.3
```{r}
par(mfrow=c(1,2))
x <- rnorm(100)
y <- 2+3*x + rnorm(100,0,4)
plot(x,y)
abline(2,3,col="red",lwd=2)
abline(lm(y~x),col="blue")

plot(x,y,type="n")
B1 <- numeric(100)
for(k in 1:100){
  x <- rnorm(100)
  y <- 2+3*x + rnorm(100,0,4)
  lm1 <- lm(y~x)
  abline(lm1,col=rgb(0,0,1,0.2))
  B1[k] <- lm1$coefficients["x"]
}
abline(2,3,col="red",lwd=2)
```

```{r}
mean(B1)
sd(B1)/10
qqnorm(B1)
```


# Multiple Linear Regression

```{r, webgl=TRUE}
# lm2 <- update(lm1, .~ . + radio) ## add second predictor
# 
# coefs <- coef(lm2)
# a <- coefs["TV"]
# b <- coefs["radio"]
# c <- -1
# d <- coefs["(Intercept)"]
# 
# AA <- BB <- Advertising[,c("TV","radio","sales")]
# BB$sales <- lm2$fitted.values
# CC <- rbind.data.frame(AA,BB)
# CC <- CC[order(CC$TV,CC$radio),]
# 
# plot3d(sales ~ TV + radio, data=Advertising, col=2)
# rglplanes <- planes3d(a, b, c, d, alpha = 0.5, col = 4)

# rglsegments <- segments3d(CC,col=1, lwd=1.5, alpha=0.8)
```



# Other Considerations



# Example Explained




# Done!

